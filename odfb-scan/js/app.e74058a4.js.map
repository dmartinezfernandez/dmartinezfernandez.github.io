{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/Folders.vue?969c","webpack:///./src/App.vue","webpack:///./src/components/SignIn.vue","webpack:///./src/msalConfig.ts","webpack:///./src/services/signService.ts","webpack:///./src/components/SignIn.vue?f7bc","webpack:///./src/components/SignIn.vue?5e7a","webpack:///./src/components/Folders.vue","webpack:///./src/services/formatBytes.ts","webpack:///./src/services/msGraph.ts","webpack:///./src/graphConfig.ts","webpack:///./src/services/appService.ts","webpack:///./src/components/Folders.vue?90d0","webpack:///./src/components/Folders.vue?fd5d","webpack:///./src/components/Loader.vue","webpack:///./src/components/Loader.vue?6ce2","webpack:///./src/components/Loader.vue?8914","webpack:///./src/App.vue?3acc","webpack:///./src/App.vue?eabf","webpack:///./src/main.ts","webpack:///./src/components/Loader.vue?1144"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","for","selected","onAuthRedirect","rootFolders","folder","id","href","webUrl","target","title","formatBytes","size","primaryFolder","disabled","isLoading","type","findMissingHashValues","Boolean","findDuplicateFiles","secondaryFolder","compareFolders","innerText","message","folderData","isTop","allowDeletion","class","style","signIn","isAuthenticated","userName","signOut","msalConfig","auth","clientId","authority","knownAuthorities","redirectUri","navigateToLoginRequestUrl","cache","cacheLocation","storeAuthStateInCookie","signService","msalInstance","username","account","getAccountByUsername","loginRedirect","scopes","handleRedirect","response","handleRedirectPromise","logout","Promise","resolve","props","emit","then","tokenResponse","catch","error","console","warn","render","__scopeId","open","count","unfilteredCount","unfilteredSize","isConfirmingDeletion","confirmDeletion","cancelDeletion","deleteFolder","files","file","folders","isDeleted","bytes","decimals","Math","floor","log","parseFloat","pow","toFixed","msGraph","getTokenRedirect","request","acquireTokenSilent","acquireTokenRedirect","msGraphGet","endpoint","accessToken","headers","Headers","append","options","method","fetch","json","msGraphDelete","delete","graphConfig","graphEndpoint","appService","newFolder","getFolder","item","driveItem","findRecursively","predicate","driveItems","child","childrenPromises","Array","childrenLength","children","all","folderId","hasHash","hashes","quickXorHash","folderWithChildrenOrNull","getHashes","filter","Set","forEach","add","promises","values","getHashesMap","Map","hash","set","has","map","primaryId","secondaryId","isDuplicate","getRootFolders","fill","stroke-width","stroke-linecap","cx","cy","width","height","viewBox","xmlns","String","default","components","SignIn","Folders","Loader","beginLoad","clearMessage","endLoad","msg","finally","fillFolderData","promise","dataMessage","noDataMessage","reason","App","mount"],"mappings":"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","file":"js/app.e74058a4.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/odfb-scan/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Folders.vue?vue&type=style&index=0&id=2fbbaec2&scoped=true&lang=css\"","<template>\n  <SignIn @onAuthRedirect=\"onAuthRedirect\" />\n  <div v-if=\"isAuthenticated\">\n    <p v-if=\"showRootFolders\">\n      Root folders:<br />\n      <template v-for=\"folder in rootFolders\" :key=\"folder.id\">\n        <a :href=\"folder.webUrl\" target=\"_blank\" :title=\"folder.id\">{{\n          folder.name\n        }}</a\n        >, {{ formatBytes(folder.size) }} <br />\n      </template>\n    </p>\n\n    <p>\n      <label for=\"primaryFolder\">Primary folder:</label><br />\n      <select\n        id=\"primaryFolder\"\n        v-model=\"primaryFolder\"\n        :key=\"primaryFolder\"\n        v-bind:disabled=\"isLoading\"\n      >\n        <option selected></option>\n        <option\n          v-for=\"folder in rootFolders\"\n          :value=\"folder.id\"\n          :key=\"folder.id\"\n        >\n          {{ folder.name }}\n        </option>\n      </select>\n      <span v-html=\"' '\" />\n      <button\n        type=\"button\"\n        @click=\"findMissingHashValues()\"\n        v-show=\"Boolean(primaryFolder)\"\n        v-bind:disabled=\"isLoading\"\n      >\n        Find missing hash values\n      </button>\n      <span v-html=\"' '\" />\n      <button\n        type=\"button\"\n        @click=\"findDuplicateFiles()\"\n        v-show=\"Boolean(primaryFolder)\"\n        v-bind:disabled=\"isLoading\"\n      >\n        Find duplicate files</button\n      ><br />\n\n      <label for=\"secondaryFolder\">Secondary folder:</label><br />\n      <select\n        id=\"secondaryFolder\"\n        v-model=\"secondaryFolder\"\n        v-bind:disabled=\"isLoading\"\n      >\n        <option selected></option>\n        <option\n          v-for=\"folder in rootFolders\"\n          :value=\"folder.id\"\n          :key=\"folder.id\"\n        >\n          {{ folder.name }}\n        </option>\n      </select>\n      <span v-html=\"' '\" />\n      <button\n        type=\"button\"\n        @click=\"compareFolders\"\n        v-show=\"\n          Boolean(primaryFolder) &&\n          Boolean(secondaryFolder) &&\n          primaryFolder != secondaryFolder\n        \"\n        title=\"Compare folders and find duplicate files\"\n        v-bind:disabled=\"isLoading\"\n      >\n        Compare folders</button\n      ><br />\n    </p>\n\n    <p>\n      <span :innerText=\"message\" />\n      <loader size=\"32px\" v-show=\"isLoading\" />\n    </p>\n\n    <p v-if=\"showFolders\">\n      <Folders\n        :data=\"folderData\"\n        :isTop=\"true\"\n        :allowDeletion=\"allowDeletion\"\n      />\n    </p>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, reactive } from \"vue\";\nimport SignIn from \"@/components/SignIn.vue\";\nimport Folders from \"@/components/Folders.vue\";\nimport Loader from \"@/components/Loader.vue\";\nimport signService from \"@/services/signService\";\nimport appService, { File, Folder } from \"@/services/appService\";\nimport formatBytes from \"@/services/formatBytes\";\nimport {\n  DriveItem,\n  Folder as DriveItemFolder,\n} from \"@microsoft/microsoft-graph-types\";\n\nexport default defineComponent({\n  name: \"App\",\n  components: {\n    SignIn,\n    Folders,\n    Loader,\n  },\n  setup() {\n    const isAuthenticated = ref(false);\n    const rootFolders = ref([] as DriveItem[]);\n    const primaryFolder = ref(\"\");\n    const secondaryFolder = ref(\"\");\n    const folderData = ref<Folder | null>(null);\n    const isLoading = ref(false);\n    const message = ref(\"\");\n    const allowDeletion = ref(false);\n\n    function beginLoad() {\n      isLoading.value = true;\n      clearMessage();\n    }\n    function endLoad(msg: string = \"\") {\n      isLoading.value = false;\n      message.value = msg;\n    }\n    function clearMessage() {\n      message.value = \"\";\n    }\n\n    function onAuthRedirect(value: boolean) {\n      isAuthenticated.value = value;\n      if (value) {\n        beginLoad();\n        appService\n          .getRootFolders()\n          .then((response) => {\n            rootFolders.value = response;\n          })\n          .finally(() => {\n            endLoad();\n          });\n      }\n    }\n\n    function fillFolderData(\n      promise: Promise<Folder | null>,\n      dataMessage: string,\n      noDataMessage: string\n    ) {\n      isLoading.value = true;\n      clearMessage();\n      promise\n        .then((folder) => {\n          folderData.value = folder;\n          message.value = folder ? dataMessage : noDataMessage;\n        })\n        .catch((reason) => {\n          message.value = reason;\n        })\n        .finally(() => {\n          isLoading.value = false;\n        });\n    }\n\n    return {\n      isAuthenticated,\n      onAuthRedirect,\n      rootFolders,\n      primaryFolder,\n      secondaryFolder,\n      folderData,\n      isLoading,\n      message,\n      allowDeletion,\n      formatBytes: (bytes: number) => {\n        return formatBytes(bytes, 2);\n      },\n      clearMessage,\n      findMissingHashValues: () => {\n        allowDeletion.value = false;\n        fillFolderData(\n          appService.findMissingHashValues(primaryFolder.value),\n          \"Missing hash values found.\",\n          \"There are no missing hash values.\"\n        );\n      },\n      findDuplicateFiles: () => {\n        allowDeletion.value = false;\n        fillFolderData(\n          appService.findDuplicateFiles(primaryFolder.value),\n          \"Duplicate files found.\",\n          \"There are no duplicate files.\"\n        );\n      },\n      compareFolders: () => {\n        allowDeletion.value = true;\n        fillFolderData(\n          appService.compareFolders(primaryFolder.value, secondaryFolder.value),\n          \"Secondary folder files found in primary folder.\",\n          \"There are no secondary folder files in primary folder.\"\n        );\n      },\n      get showFolders() {\n        return !isLoading.value && folderData.value;\n      },\n      get showRootFolders() {\n        return isAuthenticated.value && rootFolders.value.length > 0;\n      },\n    };\n  },\n});\n</script>\n\n<style scoped>\n</style>\n","<template>\r\n  <div class=\"sign-in\">\r\n    <button type=\"button\" @click=\"signIn()\" v-show=\"!isAuthenticated\">\r\n      Sign In\r\n    </button>\r\n    <span style=\"margin-right: 8px\">{{ userName }}</span>\r\n    <span v-show=\"isAuthenticated\" v-html=\"' '\" />\r\n    <button type=\"button\" @click=\"signOut()\" v-show=\"isAuthenticated\">\r\n      Sign out\r\n    </button>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent, ref, reactive } from \"vue\";\r\nimport signService from \"@/services/signService\";\r\n\r\nexport default defineComponent({\r\n  name: \"SignIn\",\r\n  setup(props, { emit }) {\r\n    // data\r\n    const userName = ref(\"\");\r\n    const isAuthenticated = ref(false);\r\n\r\n    // methods\r\n    const signIn = () => {\r\n      // I like redirect rather than popup but I have no reason to.\r\n      signService.loginRedirect();\r\n    };\r\n    const signOut = () => {\r\n      signService.logout().then((response) => {\r\n        isAuthenticated.value = false;\r\n        userName.value = \"\";\r\n        emit(\"onAuthRedirect\", isAuthenticated.value);\r\n      });\r\n    };\r\n\r\n    //// created()\r\n\r\n    // Handle the redirect flows\r\n    signService\r\n      .handleRedirect()\r\n      .then((tokenResponse: any) => {\r\n        // Handle redirect response\r\n        userName.value = tokenResponse ? tokenResponse.account?.username : null;\r\n        isAuthenticated.value = Boolean(tokenResponse && userName.value);\r\n        emit(\"onAuthRedirect\", isAuthenticated.value);\r\n      })\r\n      .catch((error: any) => {\r\n        userName.value = \"Authentication error!\";\r\n        isAuthenticated.value = false;\r\n        console.warn(error);\r\n      });\r\n\r\n    return {\r\n      // props\r\n      isAuthenticated,\r\n      userName,\r\n      // methods\r\n      signIn,\r\n      signOut,\r\n    };\r\n  },\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n</style>","import { LogLevel } from \"@azure/msal-browser\";\r\n\r\n/**\r\n * Configuration object to be passed to MSAL instance on creation. \r\n * For a full list of MSAL.js configuration parameters, visit:\r\n * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/configuration.md \r\n */\r\nconst msalConfig = {\r\n    auth: {\r\n        clientId: \"b97955ee-2bfc-4ac6-9e55-aafe57353082\",\r\n        authority:\r\n            \"https://login.microsoftonline.com/8a3f0985-1f2f-4bb2-8840-14950cc04671\",\r\n        knownAuthorities: [],\r\n        redirectUri: \"https://dmartinezfernandez.github.io/odfb-scan/\", // Change when building for production. (https://dmartinezfernandez.github.io/odfb-scan/, http://localhost:8080/)\r\n        navigateToLoginRequestUrl: true,\r\n    },\r\n    cache: {\r\n        cacheLocation: \"sessionStorage\",\r\n        storeAuthStateInCookie: false,\r\n    },\r\n    /*     system: {\r\n            loggerOptions: {\r\n                loggerCallback: (\r\n                    level: LogLevel,\r\n                    message: string,\r\n                    containsPii: boolean\r\n                ): void => {\r\n                    if (containsPii) {\r\n                        return;\r\n                    }\r\n                    switch (level) {\r\n                        case LogLevel.Error:\r\n                            console.error(message);\r\n                            return;\r\n                        case LogLevel.Info:\r\n                            console.info(message);\r\n                            return;\r\n                        case LogLevel.Verbose:\r\n                            console.debug(message);\r\n                            return;\r\n                        case LogLevel.Warning:\r\n                            console.warn(message);\r\n                            return;\r\n                    }\r\n                },\r\n                piiLoggingEnabled: false,\r\n            },\r\n            windowHashTimeout: 60000,\r\n            iframeHashTimeout: 6000,\r\n            loadFrameTimeout: 0,\r\n        }, */\r\n};\r\n\r\nexport default msalConfig;","import { PublicClientApplication, AccountInfo } from \"@azure/msal-browser\";\r\nimport msalConfig from \"@/msalConfig\";\r\n\r\nconst signService = (() => {\r\n\r\n    const msalInstance = new PublicClientApplication(msalConfig);\r\n\r\n    let username: string | null;\r\n    const isAuthenticated = () => username !== null;\r\n    const account = () => msalInstance.getAccountByUsername(username as string);\r\n\r\n    return {\r\n        loginRedirect: () => {\r\n            msalInstance.loginRedirect({\r\n                scopes: [\"User.Read\", \"Files.Read\"],\r\n            });\r\n        },\r\n        handleRedirect: async () => {\r\n            let response = await msalInstance.handleRedirectPromise();\r\n            username = response?.account?.username || null;\r\n            return response;\r\n        },\r\n        logout: () => {\r\n            return isAuthenticated() ?\r\n                msalInstance.logout({\r\n                    account: account() as AccountInfo,\r\n                    authority: msalConfig.auth.authority\r\n                }) :\r\n                Promise.resolve();\r\n        },\r\n        get username() {\r\n            return username;\r\n        }\r\n    };\r\n})();\r\n\r\nexport default signService;","\r\nimport { defineComponent, ref, reactive } from \"vue\";\r\nimport signService from \"@/services/signService\";\r\n\r\nexport default defineComponent({\r\n  name: \"SignIn\",\r\n  setup(props, { emit }) {\r\n    // data\r\n    const userName = ref(\"\");\r\n    const isAuthenticated = ref(false);\r\n\r\n    // methods\r\n    const signIn = () => {\r\n      // I like redirect rather than popup but I have no reason to.\r\n      signService.loginRedirect();\r\n    };\r\n    const signOut = () => {\r\n      signService.logout().then((response) => {\r\n        isAuthenticated.value = false;\r\n        userName.value = \"\";\r\n        emit(\"onAuthRedirect\", isAuthenticated.value);\r\n      });\r\n    };\r\n\r\n    //// created()\r\n\r\n    // Handle the redirect flows\r\n    signService\r\n      .handleRedirect()\r\n      .then((tokenResponse: any) => {\r\n        // Handle redirect response\r\n        userName.value = tokenResponse ? tokenResponse.account?.username : null;\r\n        isAuthenticated.value = Boolean(tokenResponse && userName.value);\r\n        emit(\"onAuthRedirect\", isAuthenticated.value);\r\n      })\r\n      .catch((error: any) => {\r\n        userName.value = \"Authentication error!\";\r\n        isAuthenticated.value = false;\r\n        console.warn(error);\r\n      });\r\n\r\n    return {\r\n      // props\r\n      isAuthenticated,\r\n      userName,\r\n      // methods\r\n      signIn,\r\n      signOut,\r\n    };\r\n  },\r\n});\r\n","import { render } from \"./SignIn.vue?vue&type=template&id=83902b9c&scoped=true&bindings={}\"\nimport script from \"./SignIn.vue?vue&type=script&lang=ts\"\nexport * from \"./SignIn.vue?vue&type=script&lang=ts\"\nscript.render = render\nscript.__scopeId = \"data-v-83902b9c\"\n\nexport default script","<template>\r\n  <details :open=\"isTop\">\r\n    <summary v-if=\"isDeleted\">'{{ data.name }}' deleted!</summary>\r\n    <summary v-else>\r\n      <a :href=\"data.webUrl\" target=\"_blank\">{{ data.name }}</a> ({{\r\n        data.count\r\n      }}\r\n      of {{ data.unfilteredCount }} files, {{ formatBytes(data.size) }} of\r\n      {{ formatBytes(data.unfilteredSize) }}, {{ data.size }} of\r\n      {{ data.unfilteredSize }} B)\r\n      <button\r\n        title=\"Delete\"\r\n        @click=\"confirmDeletion\"\r\n        v-if=\"allowDeletion && !isConfirmingDeletion\"\r\n      >\r\n        ⌫\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        @click=\"cancelDeletion\"\r\n        v-show=\"isConfirmingDeletion\"\r\n      >\r\n        Cancel\r\n      </button>\r\n      <span v-show=\"isConfirmingDeletion\" v-html=\"' '\" />\r\n      <button type=\"button\" @click=\"deleteFolder\" v-show=\"isConfirmingDeletion\">\r\n        Delete\r\n      </button>\r\n    </summary>\r\n    <div v-show=\"!isDeleted\">\r\n      <template v-for=\"file in data.files\" :key=\"file.id\">\r\n        <a\r\n          style=\"margin-left: 17px; display: inline-block\"\r\n          :href=\"file.webUrl\"\r\n          target=\"_blank\"\r\n          >{{ file.name }}</a\r\n        ><br />\r\n      </template>\r\n      <folders\r\n        style=\"margin-left: 17px\"\r\n        v-for=\"folder in data.folders\"\r\n        :key=\"folder.id\"\r\n        :data=\"folder\"\r\n        :isTop=\"false\"\r\n        v-bind:allowDeletion=\"allowDeletion\"\r\n      />\r\n    </div>\r\n  </details>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent, ref, onMounted } from \"vue\";\r\nimport formatBytes from \"@/services/formatBytes\";\r\nimport appService, { Folder, File } from \"@/services/appService\";\r\n\r\nexport default defineComponent({\r\n  name: \"Folders\",\r\n  props: {\r\n    data: Object,\r\n    isTop: Boolean,\r\n    allowDeletion: Boolean,\r\n  },\r\n  setup(props) {\r\n    const isConfirmingDeletion = ref(false);\r\n    const isDeleted = ref(false);\r\n    return {\r\n      isConfirmingDeletion,\r\n      isDeleted,\r\n      formatBytes,\r\n      deleteFolder: () => {\r\n        appService.delete(props.data as Folder, props.isTop);\r\n        isDeleted.value = true;\r\n      },\r\n      confirmDeletion: () => {\r\n        isConfirmingDeletion.value = true;\r\n      },\r\n      cancelDeletion: () => {\r\n        isConfirmingDeletion.value = false;\r\n      },\r\n    };\r\n  },\r\n});\r\n</script>\r\n\r\n<style scoped>\r\ndetails details {\r\n  margin-top: 1px;\r\n}\r\n</style>","export default function formatBytes(bytes: number, decimals = 2) {\r\n    if (0 === bytes)\r\n        return \"0 B\";\r\n    const c = 0 > decimals ? 0 : decimals,\r\n        d = Math.floor(Math.log(bytes) / Math.log(1024));\r\n    return parseFloat((bytes / Math.pow(1024, d)).toFixed(c)) + \" \" + [\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"][d];\r\n}","import { PublicClientApplication, AccountInfo, SilentRequest, InteractionRequiredAuthError, AuthenticationResult } from \"@azure/msal-browser\";\r\nimport msalConfig from \"@/msalConfig\";\r\nimport signService from '@/services/signService';\r\n\r\nconst msGraph = (() => {\r\n\r\n    const msalInstance = new PublicClientApplication(msalConfig);\r\n\r\n    function getTokenRedirect(request: SilentRequest) {\r\n        /**\r\n         * See here for more info on account retrieval: \r\n         * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-common/docs/Accounts.md\r\n         */\r\n        //request.account = msalInstance.getAccountByUsername(username as string) as AccountInfo;\r\n        request.account = msalInstance.getAccountByUsername(signService.username as string) as AccountInfo;\r\n\r\n        return msalInstance.acquireTokenSilent(request)\r\n            .catch(error => {\r\n                console.warn(\"silent token acquisition fails. acquiring token using redirect\");\r\n                if (error instanceof InteractionRequiredAuthError) {\r\n                    // fallback to interaction when silent call fails\r\n                    return msalInstance.acquireTokenRedirect(request);\r\n                } else {\r\n                    console.warn(error);\r\n                }\r\n            });\r\n    }\r\n\r\n    /** \r\n     * Helper function to call MS Graph API endpoint\r\n     * using the authorization bearer token scheme\r\n     * */\r\n    function msGraphGet(endpoint: RequestInfo, scopes: string[]) {\r\n        const request = { scopes } as SilentRequest;\r\n\r\n        return getTokenRedirect(request)\r\n            .then(response => {\r\n                const accessToken = (response as AuthenticationResult).accessToken;\r\n                const headers = new Headers();\r\n                headers.append(\"Authorization\", `Bearer ${accessToken}`);\r\n                const options = {\r\n                    method: \"GET\",\r\n                    headers\r\n                };\r\n                return fetch(endpoint, options)\r\n                    .then(response => response.json());\r\n            });\r\n    }\r\n\r\n    function msGraphDelete(endpoint: RequestInfo, scopes: string[]) {\r\n        const request = { scopes } as SilentRequest;\r\n\r\n        return getTokenRedirect(request)\r\n            .then(response => {\r\n                const accessToken = (response as AuthenticationResult).accessToken;\r\n                const headers = new Headers();\r\n                headers.append(\"Authorization\", `Bearer ${accessToken}`);\r\n                const options = {\r\n                    method: \"DELETE\",\r\n                    headers\r\n                };\r\n                return fetch(endpoint, options);\r\n            });\r\n    }\r\n\r\n    return {\r\n        get: msGraphGet,\r\n        delete: msGraphDelete\r\n    };\r\n})();\r\n\r\nexport default msGraph;","// Add here the endpoints for MS Graph API services you would like to use.\r\nconst graphConfig = {\r\n    graphEndpoint: \"https://graph.microsoft.com/v1.0\"\r\n};\r\nexport default graphConfig;","import { DriveItem, Folder as DriveItemFolder } from \"@microsoft/microsoft-graph-types\";\r\nimport msGraph from \"@/services/msGraph\"\r\nimport graphConfig from \"@/graphConfig\"\r\n\r\ntype Node = {\r\n    id: string;\r\n    name: string | null | undefined;\r\n    webUrl: string | null | undefined;\r\n}\r\nexport type File = Node;\r\nexport type Folder = Node & {\r\n    folders: Folder[];\r\n    files: File[];\r\n    /** Filtered files count. */\r\n    count: number;\r\n    /** Filtered files size. */\r\n    size: number;\r\n    /** Unfiltered files count. */\r\n    unfilteredCount: number;\r\n    /** Unfiltered files size. */\r\n    unfilteredSize: number;\r\n}\r\n\r\nconst appService = (() => {\r\n\r\n    function newFolder(id: string, name: string | null = null, webUrl: string | null = null) {\r\n        return {\r\n            id,\r\n            name,\r\n            webUrl,\r\n            folders: [] as Folder[],\r\n            files: [] as File[],\r\n            count: 0,\r\n            size: 0,\r\n            unfilteredCount: 0,\r\n            unfilteredSize: 0\r\n        } as Folder;\r\n    }\r\n\r\n    function getFolder(id: string) {\r\n        return msGraph.get(`${graphConfig.graphEndpoint}/me/drive/items/${id}`, [\"Files.Read\"])\r\n            .then((item) => {\r\n                const driveItem = item as DriveItem;\r\n                return newFolder(id, driveItem.name, driveItem.webUrl);\r\n            });\r\n    }\r\n\r\n    function findRecursively(folder: Folder, predicate: (item: DriveItem) => boolean) {\r\n        return msGraph.get(`${graphConfig.graphEndpoint}/me/drive/items/${folder.id}/children`, [\"Files.Read\"])\r\n            .then(async (response) => {\r\n                const driveItems = response.value as DriveItem[];\r\n                let childrenPromises = Array<Promise<any>>();\r\n                let childrenLength = 0;\r\n                let child: Folder;\r\n                for (let i = 0; i < driveItems.length; i++) {\r\n                    if (driveItems[i].folder) { // Folder\r\n                        child = newFolder(driveItems[i].id as string,\r\n                            driveItems[i].name,\r\n                            driveItems[i].webUrl);\r\n                        childrenLength = childrenPromises.push(findRecursively(child, predicate));\r\n                    }\r\n                    else { // File\r\n                        if (predicate(driveItems[i])) {\r\n                            folder.files.push({\r\n                                id: driveItems[i].id as string,\r\n                                name: driveItems[i].name,\r\n                                webUrl: driveItems[i].webUrl\r\n                            });\r\n                            folder.count++;\r\n                            folder.size += driveItems[i].size as number;\r\n                        }\r\n                        folder.unfilteredCount++;\r\n                        folder.unfilteredSize += driveItems[i].size as number;\r\n                    }\r\n                }\r\n                // awaiting multiple values (https://medium.com/@bluepnume/learn-about-promises-before-you-start-using-async-await-eb148164a9c8)\r\n                let children = await Promise.all(childrenPromises);\r\n                for (let i = 0; i < children.length; i++) {\r\n                    if (children[i].files.length > 0 || children[i].folders.length > 0) {\r\n                        folder.folders.push(children[i]);\r\n                        folder.count += children[i].count;\r\n                        folder.size += children[i].size;\r\n                    }\r\n                    folder.unfilteredCount += children[i].unfilteredCount;\r\n                    folder.unfilteredSize += children[i].unfilteredSize;\r\n                }\r\n                return folder;\r\n            });\r\n    }\r\n\r\n    async function findMissingHashValues(folderId: string) {\r\n        return getFolder(folderId)\r\n            .then(folder => {\r\n                const hasHash = (item: DriveItem) => !item.file?.hashes?.quickXorHash;\r\n                return findRecursively(folder, hasHash)\r\n                    .then(response => folderWithChildrenOrNull(response));\r\n            });\r\n    }\r\n    function folderWithChildrenOrNull(folder: Folder) {\r\n        return folder.files.length == 0 && folder.folders.length == 0 ? null : folder;\r\n    }\r\n    async function getHashes(folderId: string) {\r\n        return msGraph.get(`${graphConfig.graphEndpoint}/me/drive/items/${folderId}/children`, [\"Files.Read\"])\r\n            .then(async (response) => {\r\n                const driveItems = response.value as DriveItem[];\r\n                const files = driveItems.filter(item => item.file,);\r\n                const folders = driveItems.filter(item => item.folder);\r\n                let hashes = new Set<string>();\r\n                files.forEach((item) => {\r\n                    if (item.file?.hashes?.quickXorHash)\r\n                        hashes.add(item.file?.hashes?.quickXorHash as string);\r\n                })\r\n                const promises: Promise<Set<string>>[] = [];\r\n                folders.forEach(item => {\r\n                    promises.push(getHashes(item.id as string));\r\n                });\r\n                let values = await Promise.all(promises);\r\n                values.forEach(value => {\r\n                    if (hashes.size == 0)\r\n                        hashes = value;\r\n                    else\r\n                        hashes = new Set([...hashes, ...value]);\r\n                });\r\n                return hashes;\r\n            });\r\n    }\r\n    async function getHashesMap(folderId: string) {\r\n        return msGraph.get(`${graphConfig.graphEndpoint}/me/drive/items/${folderId}/children`, [\"Files.Read\"])\r\n            .then(async (response) => {\r\n                const driveItems = response.value as DriveItem[];\r\n                const files = driveItems.filter(item => item.file,);\r\n                const folders = driveItems.filter(item => item.folder);\r\n                let hashes = new Map<string, boolean>();\r\n                files.forEach(item => {\r\n                    const hash = item.file?.hashes?.quickXorHash;\r\n                    if (hash)\r\n                        hashes.set(hash, hashes.has(hash));\r\n                });\r\n                const promises: Promise<Map<string, boolean>>[] = [];\r\n                folders.forEach(item => {\r\n                    promises.push(getHashesMap(item.id as string));\r\n                });\r\n                let values = await Promise.all(promises);\r\n                values.forEach(map => {\r\n                    map.forEach((value: boolean, key: string) => {\r\n                        hashes.set(key, value || hashes.has(key));\r\n                    });\r\n                });\r\n                return hashes;\r\n            });\r\n    }\r\n\r\n    async function findDuplicateFiles(folderId: string) {\r\n        return getHashesMap(folderId)\r\n            .then((map: Map<string, boolean>) => {\r\n                const hashes = new Set<string>();\r\n                map.forEach((value, key) => {\r\n                    if (value)\r\n                        hashes.add(key);\r\n                });\r\n                return getFolder(folderId)\r\n                    .then(folder => {\r\n                        const predicate = (item: DriveItem) => {\r\n                            let hash = item.file?.hashes?.quickXorHash;\r\n                            return Boolean(hash && hashes.has(hash));\r\n                        };\r\n                        return findRecursively(folder, predicate)\r\n                            .then(response => folderWithChildrenOrNull(response));\r\n                    });\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Find files in secondary folder wich already exist in primary folder.\r\n     * @param primaryId \r\n     * @param secondaryId \r\n     */\r\n    async function compareFolders(primaryId: string, secondaryId: string) {\r\n        let folder = newFolder(secondaryId);\r\n        return getHashes(primaryId)\r\n            .then(hashes => {\r\n                let i: number = 0;\r\n                const isDuplicate = (item: DriveItem) => {\r\n                    let hash: string | null = item.file?.hashes?.quickXorHash || null;\r\n                    return Boolean(hash && hashes.has(hash));\r\n                }\r\n                return findRecursively(folder, isDuplicate)\r\n                    .then(response => {\r\n                        folder = response;\r\n                        if (folder.files.length == 0 && folder.folders.length == 0)\r\n                            return null;\r\n                        else\r\n                            return msGraph.get(`${graphConfig.graphEndpoint}/me/drive/items/${secondaryId}`, [\"Files.Read\"])\r\n                                .then(item => {\r\n                                    const driveItem = item as DriveItem;\r\n                                    folder.name = driveItem.name;\r\n                                    folder.webUrl = driveItem.webUrl;\r\n                                    return folder;\r\n                                })\r\n                    })\r\n            });\r\n    }\r\n\r\n    function deleteFolder(folder: Folder, isTop: boolean) {\r\n        if (folder.count == folder.unfilteredCount && !isTop) {\r\n            msGraph.delete(\r\n                `${graphConfig.graphEndpoint}/me/drive/items/${folder.id}`,\r\n                [\"Files.ReadWrite\"]\r\n            );\r\n        }\r\n        else {\r\n            folder.files.forEach(file =>\r\n                msGraph.delete(\r\n                    `${graphConfig.graphEndpoint}/me/drive/items/${file.id}`,\r\n                    [\"Files.ReadWrite\"]\r\n                ));\r\n            folder.folders.forEach(child => deleteFolder(child, false));\r\n        }\r\n    }\r\n\r\n    return {\r\n        /** Drive root folders\r\n         * @returns DriveItem[]\r\n         */\r\n        getRootFolders: () => msGraph.get(\r\n            `${graphConfig.graphEndpoint}/me/drive/root/children`,\r\n            [\"Files.Read\"])\r\n            .then(response => response.value.filter((item: DriveItem) => item.folder) as DriveItem[]),\r\n        findMissingHashValues,\r\n        findDuplicateFiles,\r\n        compareFolders,\r\n        delete: deleteFolder\r\n    };\r\n})();\r\n\r\nexport default appService;","\r\nimport { defineComponent, ref, onMounted } from \"vue\";\r\nimport formatBytes from \"@/services/formatBytes\";\r\nimport appService, { Folder, File } from \"@/services/appService\";\r\n\r\nexport default defineComponent({\r\n  name: \"Folders\",\r\n  props: {\r\n    data: Object,\r\n    isTop: Boolean,\r\n    allowDeletion: Boolean,\r\n  },\r\n  setup(props) {\r\n    const isConfirmingDeletion = ref(false);\r\n    const isDeleted = ref(false);\r\n    return {\r\n      isConfirmingDeletion,\r\n      isDeleted,\r\n      formatBytes,\r\n      deleteFolder: () => {\r\n        appService.delete(props.data as Folder, props.isTop);\r\n        isDeleted.value = true;\r\n      },\r\n      confirmDeletion: () => {\r\n        isConfirmingDeletion.value = true;\r\n      },\r\n      cancelDeletion: () => {\r\n        isConfirmingDeletion.value = false;\r\n      },\r\n    };\r\n  },\r\n});\r\n","import { render } from \"./Folders.vue?vue&type=template&id=2fbbaec2&scoped=true&bindings={}\"\nimport script from \"./Folders.vue?vue&type=script&lang=ts\"\nexport * from \"./Folders.vue?vue&type=script&lang=ts\"\n\nimport \"./Folders.vue?vue&type=style&index=0&id=2fbbaec2&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-2fbbaec2\"\n\nexport default script","<!-- https://codepen.io/KryptikOne/pen/KpeVyZ -->\r\n<template>\r\n  <svg\r\n    class=\"spinner\"\r\n    :width=\"size\"\r\n    :height=\"size\"\r\n    viewBox=\"0 0 66 66\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n  >\r\n    <circle\r\n      class=\"path\"\r\n      fill=\"none\"\r\n      stroke-width=\"6\"\r\n      stroke-linecap=\"round\"\r\n      cx=\"33\"\r\n      cy=\"33\"\r\n      r=\"30\"\r\n    ></circle>\r\n  </svg>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from \"vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"Loader\",\r\n  props: {\r\n    size: { type: String, default: \"32px\" },\r\n  },\r\n});\r\n</script>\r\n\r\n<style scoped>\r\nhtml,\r\nbody {\r\n  height: 100%;\r\n}\r\n\r\nbody {\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-align: center;\r\n  -webkit-align-items: center;\r\n  -ms-flex-align: center;\r\n  align-items: center;\r\n  -webkit-box-pack: center;\r\n  -webkit-justify-content: center;\r\n  -ms-flex-pack: center;\r\n  justify-content: center;\r\n}\r\n\r\n.spinner {\r\n  -webkit-animation: rotator 1.4s linear infinite;\r\n  animation: rotator 1.4s linear infinite;\r\n}\r\n\r\n@-webkit-keyframes rotator {\r\n  0% {\r\n    -webkit-transform: rotate(0deg);\r\n    transform: rotate(0deg);\r\n  }\r\n  100% {\r\n    -webkit-transform: rotate(270deg);\r\n    transform: rotate(270deg);\r\n  }\r\n}\r\n\r\n@keyframes rotator {\r\n  0% {\r\n    -webkit-transform: rotate(0deg);\r\n    transform: rotate(0deg);\r\n  }\r\n  100% {\r\n    -webkit-transform: rotate(270deg);\r\n    transform: rotate(270deg);\r\n  }\r\n}\r\n.path {\r\n  stroke-dasharray: 187;\r\n  stroke-dashoffset: 0;\r\n  -webkit-transform-origin: center;\r\n  -ms-transform-origin: center;\r\n  transform-origin: center;\r\n  -webkit-animation: dash 1.4s ease-in-out infinite,\r\n    colors 5.6s ease-in-out infinite;\r\n  animation: dash 1.4s ease-in-out infinite, colors 5.6s ease-in-out infinite;\r\n}\r\n\r\n@-webkit-keyframes colors {\r\n  0% {\r\n    stroke: red;\r\n  }\r\n  14.285714286% {\r\n    stroke: orange;\r\n  }\r\n  28.571428572% {\r\n    stroke: yellow;\r\n  }\r\n  42.857142858% {\r\n    stroke: green;\r\n  }\r\n  57.142857144% {\r\n    stroke: blue;\r\n  }\r\n  71.42857143% {\r\n    stroke: indigo;\r\n  }\r\n  100% {\r\n    stroke: violet;\r\n  }\r\n}\r\n\r\n@keyframes colors {\r\n  0% {\r\n    stroke: red;\r\n  }\r\n  14.285714286% {\r\n    stroke: orange;\r\n  }\r\n  28.571428572% {\r\n    stroke: yellow;\r\n  }\r\n  42.857142858% {\r\n    stroke: green;\r\n  }\r\n  57.142857144% {\r\n    stroke: blue;\r\n  }\r\n  71.42857143% {\r\n    stroke: indigo;\r\n  }\r\n  100% {\r\n    stroke: violet;\r\n  }\r\n}\r\n@-webkit-keyframes dash {\r\n  0% {\r\n    stroke-dashoffset: 187;\r\n  }\r\n  50% {\r\n    stroke-dashoffset: 46.75;\r\n    -webkit-transform: rotate(135deg);\r\n    transform: rotate(135deg);\r\n  }\r\n  100% {\r\n    stroke-dashoffset: 187;\r\n    -webkit-transform: rotate(450deg);\r\n    transform: rotate(450deg);\r\n  }\r\n}\r\n@keyframes dash {\r\n  0% {\r\n    stroke-dashoffset: 187;\r\n  }\r\n  50% {\r\n    stroke-dashoffset: 46.75;\r\n    -webkit-transform: rotate(135deg);\r\n    transform: rotate(135deg);\r\n  }\r\n  100% {\r\n    stroke-dashoffset: 187;\r\n    -webkit-transform: rotate(450deg);\r\n    transform: rotate(450deg);\r\n  }\r\n}\r\n</style>","\r\nimport { defineComponent } from \"vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"Loader\",\r\n  props: {\r\n    size: { type: String, default: \"32px\" },\r\n  },\r\n});\r\n","import { render } from \"./Loader.vue?vue&type=template&id=00e81b60&scoped=true&bindings={}\"\nimport script from \"./Loader.vue?vue&type=script&lang=ts\"\nexport * from \"./Loader.vue?vue&type=script&lang=ts\"\n\nimport \"./Loader.vue?vue&type=style&index=0&id=00e81b60&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-00e81b60\"\n\nexport default script","\nimport { defineComponent, ref, reactive } from \"vue\";\nimport SignIn from \"@/components/SignIn.vue\";\nimport Folders from \"@/components/Folders.vue\";\nimport Loader from \"@/components/Loader.vue\";\nimport signService from \"@/services/signService\";\nimport appService, { File, Folder } from \"@/services/appService\";\nimport formatBytes from \"@/services/formatBytes\";\nimport {\n  DriveItem,\n  Folder as DriveItemFolder,\n} from \"@microsoft/microsoft-graph-types\";\n\nexport default defineComponent({\n  name: \"App\",\n  components: {\n    SignIn,\n    Folders,\n    Loader,\n  },\n  setup() {\n    const isAuthenticated = ref(false);\n    const rootFolders = ref([] as DriveItem[]);\n    const primaryFolder = ref(\"\");\n    const secondaryFolder = ref(\"\");\n    const folderData = ref<Folder | null>(null);\n    const isLoading = ref(false);\n    const message = ref(\"\");\n    const allowDeletion = ref(false);\n\n    function beginLoad() {\n      isLoading.value = true;\n      clearMessage();\n    }\n    function endLoad(msg: string = \"\") {\n      isLoading.value = false;\n      message.value = msg;\n    }\n    function clearMessage() {\n      message.value = \"\";\n    }\n\n    function onAuthRedirect(value: boolean) {\n      isAuthenticated.value = value;\n      if (value) {\n        beginLoad();\n        appService\n          .getRootFolders()\n          .then((response) => {\n            rootFolders.value = response;\n          })\n          .finally(() => {\n            endLoad();\n          });\n      }\n    }\n\n    function fillFolderData(\n      promise: Promise<Folder | null>,\n      dataMessage: string,\n      noDataMessage: string\n    ) {\n      isLoading.value = true;\n      clearMessage();\n      promise\n        .then((folder) => {\n          folderData.value = folder;\n          message.value = folder ? dataMessage : noDataMessage;\n        })\n        .catch((reason) => {\n          message.value = reason;\n        })\n        .finally(() => {\n          isLoading.value = false;\n        });\n    }\n\n    return {\n      isAuthenticated,\n      onAuthRedirect,\n      rootFolders,\n      primaryFolder,\n      secondaryFolder,\n      folderData,\n      isLoading,\n      message,\n      allowDeletion,\n      formatBytes: (bytes: number) => {\n        return formatBytes(bytes, 2);\n      },\n      clearMessage,\n      findMissingHashValues: () => {\n        allowDeletion.value = false;\n        fillFolderData(\n          appService.findMissingHashValues(primaryFolder.value),\n          \"Missing hash values found.\",\n          \"There are no missing hash values.\"\n        );\n      },\n      findDuplicateFiles: () => {\n        allowDeletion.value = false;\n        fillFolderData(\n          appService.findDuplicateFiles(primaryFolder.value),\n          \"Duplicate files found.\",\n          \"There are no duplicate files.\"\n        );\n      },\n      compareFolders: () => {\n        allowDeletion.value = true;\n        fillFolderData(\n          appService.compareFolders(primaryFolder.value, secondaryFolder.value),\n          \"Secondary folder files found in primary folder.\",\n          \"There are no secondary folder files in primary folder.\"\n        );\n      },\n      get showFolders() {\n        return !isLoading.value && folderData.value;\n      },\n      get showRootFolders() {\n        return isAuthenticated.value && rootFolders.value.length > 0;\n      },\n    };\n  },\n});\n","import { render } from \"./App.vue?vue&type=template&id=089d265e&scoped=true&bindings={}\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\nscript.render = render\nscript.__scopeId = \"data-v-089d265e\"\n\nexport default script","import { createApp } from 'vue'\nimport App from './App.vue'\n\ncreateApp(App).mount('#app')\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Loader.vue?vue&type=style&index=0&id=00e81b60&scoped=true&lang=css\""],"sourceRoot":""}