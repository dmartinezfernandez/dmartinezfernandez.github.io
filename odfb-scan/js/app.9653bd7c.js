(function(e){function t(t){for(var r,i,a=t[0],c=t[1],s=t[2],u=0,b=[];u<a.length;u++)i=a[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&b.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);d&&d(t);while(b.length)b.shift()();return l.push.apply(l,s||[]),n()}function n(){for(var e,t=0;t<l.length;t++){for(var n=l[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(r=!1)}r&&(l.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},l=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/odfb-scan/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var d=c;l.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},a2b9:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);var r=n("7a23");const o=Object(r["r"])("data-v-657be01a");Object(r["j"])("data-v-657be01a");const l={key:0},i={key:0},a=Object(r["e"])(" Root folders:"),c=Object(r["f"])("br",null,null,-1),s=Object(r["f"])("br",null,null,-1),d=Object(r["f"])("label",{for:"primaryFolder"},"Primary folder:",-1),u=Object(r["f"])("br",null,null,-1),b=Object(r["f"])("option",{selected:""},null,-1),f=Object(r["f"])("br",null,null,-1),h=Object(r["f"])("label",{for:"secondaryFolder"},"Secondary folder:",-1),v=Object(r["f"])("br",null,null,-1),p=Object(r["f"])("option",{selected:""},null,-1),O=Object(r["f"])("br",null,null,-1),j={key:1};Object(r["i"])();const g=o((function(e,t,n,o,g,m){const y=Object(r["m"])("SignIn"),F=Object(r["m"])("loader"),w=Object(r["m"])("Folders");return Object(r["h"])(),Object(r["c"])(r["a"],null,[Object(r["f"])(y,{onOnAuthRedirect:e.onAuthRedirect},null,8,["onOnAuthRedirect"]),e.isAuthenticated?(Object(r["h"])(),Object(r["c"])("div",l,[e.showRootFolders?(Object(r["h"])(),Object(r["c"])("p",i,[a,c,(Object(r["h"])(!0),Object(r["c"])(r["a"],null,Object(r["l"])(e.rootFolders,t=>(Object(r["h"])(),Object(r["c"])(r["a"],{key:t.id},[Object(r["f"])("a",{href:t.webUrl,target:"_blank",title:t.id},Object(r["n"])(t.name),9,["href","title"]),Object(r["e"])(", "+Object(r["n"])(e.formatBytes(t.size)),1),s],64))),128))])):Object(r["d"])("",!0),Object(r["f"])("p",null,[d,u,Object(r["q"])((Object(r["h"])(),Object(r["c"])("select",{style:{"margin-right":"8px"},id:"primaryFolder","onUpdate:modelValue":t[1]||(t[1]=t=>e.primaryFolder=t),key:e.primaryFolder,disabled:e.isLoading},[b,(Object(r["h"])(!0),Object(r["c"])(r["a"],null,Object(r["l"])(e.rootFolders,e=>(Object(r["h"])(),Object(r["c"])("option",{value:e.id,key:e.id},Object(r["n"])(e.name),9,["value"]))),128))],8,["disabled"])),[[r["o"],e.primaryFolder]]),Object(r["q"])(Object(r["f"])("button",{style:{"margin-right":"8px"},type:"button",onClick:t[2]||(t[2]=t=>e.findMissingHashValues()),disabled:e.isLoading}," Find missing hash values ",8,["disabled"]),[[r["p"],Boolean(e.primaryFolder)]]),Object(r["q"])(Object(r["f"])("button",{type:"button",onClick:t[3]||(t[3]=t=>e.findDuplicateFiles()),disabled:e.isLoading}," Find duplicate files",8,["disabled"]),[[r["p"],Boolean(e.primaryFolder)]]),f,h,v,Object(r["q"])(Object(r["f"])("select",{style:{"margin-right":"8px"},id:"secondaryFolder","onUpdate:modelValue":t[4]||(t[4]=t=>e.secondaryFolder=t),disabled:e.isLoading},[p,(Object(r["h"])(!0),Object(r["c"])(r["a"],null,Object(r["l"])(e.rootFolders,e=>(Object(r["h"])(),Object(r["c"])("option",{value:e.id,key:e.id},Object(r["n"])(e.name),9,["value"]))),128))],8,["disabled"]),[[r["o"],e.secondaryFolder]]),Object(r["q"])(Object(r["f"])("button",{type:"button",onClick:t[5]||(t[5]=(...t)=>e.compareFolders(...t)),title:"Compare folders and find duplicate files",disabled:e.isLoading}," Compare folders",8,["disabled"]),[[r["p"],Boolean(e.primaryFolder)&&Boolean(e.secondaryFolder)&&e.primaryFolder!=e.secondaryFolder]]),O]),Object(r["f"])("p",null,[Object(r["f"])("span",{innerText:e.message},null,8,["innerText"]),Object(r["q"])(Object(r["f"])(F,{size:"32px"},null,512),[[r["p"],e.isLoading]])]),e.showFolders?(Object(r["h"])(),Object(r["c"])("p",j,[Object(r["f"])(w,{data:e.folderData},null,8,["data"])])):Object(r["d"])("",!0)])):Object(r["d"])("",!0)],64)})),m=Object(r["r"])("data-v-0cf489ec");Object(r["j"])("data-v-0cf489ec");const y={class:"sign-in"},F={style:{"margin-right":"8px"}};Object(r["i"])();const w=m((function(e,t,n,o,l,i){return Object(r["h"])(),Object(r["c"])("div",y,[Object(r["q"])(Object(r["f"])("button",{type:"button",onClick:t[1]||(t[1]=t=>e.signIn())}," Sign In ",512),[[r["p"],!e.isAuthenticated]]),Object(r["f"])("span",F,Object(r["n"])(e.userName),1),Object(r["q"])(Object(r["f"])("button",{type:"button",onClick:t[2]||(t[2]=t=>e.signOut()),style:{"margin-top":"2px"}}," Sign out ",512),[[r["p"],e.isAuthenticated]])])}));var k=n("9ab4"),R=n("bbcb");const B={auth:{clientId:"b97955ee-2bfc-4ac6-9e55-aafe57353082",authority:"https://login.microsoftonline.com/8a3f0985-1f2f-4bb2-8840-14950cc04671",knownAuthorities:[],redirectUri:"https://dmartinezfernandez.github.io/odfb-scan/",navigateToLoginRequestUrl:!0},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}};var x=B;const A=(()=>{const e=new R["b"](x);let t;const n=()=>null!==t,r=()=>e.getAccountByUsername(t);return{loginRedirect:()=>{e.loginRedirect({scopes:["User.Read","Files.Read"]})},handleRedirect:()=>Object(k["a"])(void 0,void 0,void 0,(function*(){var n;let r=yield e.handleRedirectPromise();return t=(null===(n=null===r||void 0===r?void 0:r.account)||void 0===n?void 0:n.username)||null,r})),logout:()=>n()?e.logout({account:r(),authority:x.auth.authority}):Promise.resolve(),get username(){return t}}})();var q=A,S=Object(r["g"])({name:"SignIn",setup(e,{emit:t}){const n=Object(r["k"])(""),o=Object(r["k"])(!1),l=()=>{q.loginRedirect()},i=()=>{q.logout().then(e=>{o.value=!1,n.value="",t("onAuthRedirect",o.value)})};return q.handleRedirect().then(e=>{var r;n.value=e?null===(r=e.account)||void 0===r?void 0:r.username:null,o.value=Boolean(e&&n.value),t("onAuthRedirect",o.value)}).catch(e=>{n.value="Authentication error!",o.value=!1,console.warn(e)}),{isAuthenticated:o,userName:n,signIn:l,signOut:i}}});S.render=w,S.__scopeId="data-v-0cf489ec";var U=S;const E=Object(r["r"])("data-v-f1880cf6");Object(r["j"])("data-v-f1880cf6");const _={class:"Folders"},M={open:""};Object(r["i"])();const P=E((function(e,t,n,o,l,i){const a=Object(r["m"])("folders");return Object(r["h"])(),Object(r["c"])("div",_,[Object(r["f"])("details",M,[Object(r["f"])("summary",null,[Object(r["f"])("a",{href:e.data.webUrl,target:"_blank"},Object(r["n"])(e.data.name),9,["href"])]),(Object(r["h"])(!0),Object(r["c"])(r["a"],null,Object(r["l"])(e.data.files,e=>(Object(r["h"])(),Object(r["c"])("a",{style:{"margin-left":"17px",display:"block"},key:e.id,href:e.webUrl,target:"_blank"},Object(r["n"])(e.name),9,["href"]))),128)),(Object(r["h"])(!0),Object(r["c"])(r["a"],null,Object(r["l"])(e.data.folders,e=>(Object(r["h"])(),Object(r["c"])(a,{style:{"margin-left":"17px"},key:e.id,data:e},null,8,["data"]))),128))])])}));var T=Object(r["g"])({name:"Folders",props:{data:Object},setup(){}});T.render=P,T.__scopeId="data-v-f1880cf6";var I=T;const H=Object(r["r"])("data-v-00e81b60");Object(r["j"])("data-v-00e81b60");const L=Object(r["f"])("circle",{class:"path",fill:"none","stroke-width":"6","stroke-linecap":"round",cx:"33",cy:"33",r:"30"},null,-1);Object(r["i"])();const $=H((function(e,t,n,o,l,i){return Object(r["h"])(),Object(r["c"])("svg",{class:"spinner",width:e.size,height:e.size,viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"},[L],8,["width","height"])}));var z=Object(r["g"])({name:"Loader",props:{size:{type:String,default:"32px"}}});n("ce7e");z.render=$,z.__scopeId="data-v-00e81b60";var C=z;const D=(()=>{const e=new R["b"](x);function t(t){return t.account=e.getAccountByUsername(q.username),e.acquireTokenSilent(t).catch(n=>{if(console.warn("silent token acquisition fails. acquiring token using redirect"),n instanceof R["a"])return e.acquireTokenRedirect(t);console.warn(n)})}function n(e,n){const r={scopes:n};return t(r).then(t=>{const n=t.accessToken,r=new Headers;r.append("Authorization","Bearer "+n);const o={method:"GET",headers:r};return fetch(e,o).then(e=>e.json())})}return{get:n}})();var V=D;const X={graphEndpoint:"https://graph.microsoft.com/v1.0"};var G=X;const J=(()=>{function e(e){return{id:e,name:null,webUrl:null,folders:[],files:[]}}function t(t){const n=e(t);return V.get(`${G.graphEndpoint}/me/drive/items/${t}`,["Files.Read"]).then(e=>{const t=e;return n.name=t.name,n.webUrl=t.webUrl,n})}function n(e,t){return V.get(`${G.graphEndpoint}/me/drive/items/${e.id}/children`,["Files.Read"]).then(r=>Object(k["a"])(this,void 0,void 0,(function*(){const o=r.value;let l,i=Array(),a=0;for(let r=0;r<o.length;r++)o[r].folder?(l={files:Array(),folders:Array(),id:o[r].id,name:o[r].name,webUrl:o[r].webUrl},a=i.push(n(l,t))):t(o[r])&&e.files.push({id:o[r].id,name:o[r].name,webUrl:o[r].webUrl});let c=yield Promise.all(i);for(let t=0;t<c.length;t++)(c[t].files.length>0||c[t].folders.length>0)&&e.folders.push(c[t]);return e})))}function r(e){return Object(k["a"])(this,void 0,void 0,(function*(){return t(e).then(e=>{const t=e=>{var t,n;return!(null===(n=null===(t=e.file)||void 0===t?void 0:t.hashes)||void 0===n?void 0:n.quickXorHash)};return n(e,t).then(e=>o(e))})}))}function o(e){return 0==e.files.length&&0==e.folders.length?null:e}function l(e){return Object(k["a"])(this,void 0,void 0,(function*(){return V.get(`${G.graphEndpoint}/me/drive/items/${e}/children`,["Files.Read"]).then(e=>Object(k["a"])(this,void 0,void 0,(function*(){const t=e.value,n=t.filter(e=>e.file),r=t.filter(e=>e.folder);let o=new Set;n.forEach(e=>{var t,n,r,l;(null===(n=null===(t=e.file)||void 0===t?void 0:t.hashes)||void 0===n?void 0:n.quickXorHash)&&o.add(null===(l=null===(r=e.file)||void 0===r?void 0:r.hashes)||void 0===l?void 0:l.quickXorHash)});const i=[];r.forEach(e=>{i.push(l(e.id))});let a=yield Promise.all(i);return a.forEach(e=>{o=0==o.size?e:new Set([...o,...e])}),o})))}))}function i(e){return Object(k["a"])(this,void 0,void 0,(function*(){return V.get(`${G.graphEndpoint}/me/drive/items/${e}/children`,["Files.Read"]).then(e=>Object(k["a"])(this,void 0,void 0,(function*(){const t=e.value,n=t.filter(e=>e.file),r=t.filter(e=>e.folder);let o=new Map;n.forEach(e=>{var t,n;const r=null===(n=null===(t=e.file)||void 0===t?void 0:t.hashes)||void 0===n?void 0:n.quickXorHash;r&&o.set(r,o.has(r))});const l=[];r.forEach(e=>{l.push(i(e.id))});let a=yield Promise.all(l);return a.forEach(e=>{e.forEach((e,t)=>{o.set(t,e||o.has(t))})}),o})))}))}function a(e){return Object(k["a"])(this,void 0,void 0,(function*(){return i(e).then(r=>{const l=new Set;return r.forEach((e,t)=>{e&&l.add(t)}),t(e).then(e=>{const t=e=>{var t,n;let r=null===(n=null===(t=e.file)||void 0===t?void 0:t.hashes)||void 0===n?void 0:n.quickXorHash;return Boolean(r&&l.has(r))};return n(e,t).then(e=>o(e))})})}))}function c(t,r){return Object(k["a"])(this,void 0,void 0,(function*(){let o=e(r);return l(t).then(e=>{const t=t=>{var n,r;let o=(null===(r=null===(n=t.file)||void 0===n?void 0:n.hashes)||void 0===r?void 0:r.quickXorHash)||null;return Boolean(o&&e.has(o))};return n(o,t).then(e=>(o=e,0==o.files.length&&0==o.folders.length?null:V.get(`${G.graphEndpoint}/me/drive/items/${r}`,["Files.Read"]).then(e=>{const t=e;return o.name=t.name,o.webUrl=t.webUrl,o})))})}))}return{getRootFolders:()=>V.get(G.graphEndpoint+"/me/drive/root/children",["Files.Read"]).then(e=>{var t;return null===(t=e.value)||void 0===t?void 0:t.filter(e=>e.folder)}),findMissingHashValues:r,findDuplicateFiles:a,compareFolders:c}})();var N=J;function K(e,t=2){if(0===e)return"0 B";const n=0>t?0:t,r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(n))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}var Y=Object(r["g"])({name:"App",components:{SignIn:U,Folders:I,Loader:C},setup(){const e=Object(r["k"])(!1),t=Object(r["k"])([]),n=Object(r["k"])(""),o=Object(r["k"])(""),l=Object(r["k"])(null),i=Object(r["k"])(!1),a=Object(r["k"])("");function c(){i.value=!0,d()}function s(e=""){i.value=!1,a.value=e}function d(){a.value=""}function u(n){e.value=n,n&&(c(),N.getRootFolders().then(e=>{t.value=e}).finally(()=>{s()}))}function b(e,t,n){i.value=!0,d(),e.then(e=>{l.value=e,a.value=e?t:n}).catch(e=>{a.value=e}).finally(()=>{i.value=!1})}return{isAuthenticated:e,onAuthRedirect:u,rootFolders:t,primaryFolder:n,secondaryFolder:o,folderData:l,isLoading:i,message:a,formatBytes:e=>K(e,2),clearMessage:d,findMissingHashValues:()=>{b(N.findMissingHashValues(n.value),"Missing hash values found.","There are no missing hash values.")},findDuplicateFiles:()=>{b(N.findDuplicateFiles(n.value),"Duplicate files found.","There are no duplicate files.")},compareFolders:()=>{b(N.compareFolders(n.value,o.value),"Secondary folder files found in primary folder.","There are no secondary folder files in primary folder.")},get showFolders(){return!i.value&&l.value},get showRootFolders(){return e.value&&t.value.length>0}}}});n("ce9c");Y.render=g,Y.__scopeId="data-v-657be01a";var Z=Y;Object(r["b"])(Z).mount("#app")},ce7e:function(e,t,n){"use strict";n("a2b9")},ce9c:function(e,t,n){"use strict";n("f627")},f627:function(e,t,n){}});
//# sourceMappingURL=app.9653bd7c.js.map